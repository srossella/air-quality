(()=>{let t,e="",n=" ";document.getElementById("input-city").addEventListener("keyup",(function(t){"Enter"===t.key&&o()}));const o=()=>(l(),(async()=>{const t=`/.netlify/functions/fetch_air_input?input=${document.getElementById("input-city").value}`;try{const e=await fetch(t);if(e.ok){const t=await e.json();return console.log(t),"ok"!=t.status&&(console.log("there was an error with the city name!"),document.getElementById("error").style.display="block",document.getElementById("error").textContent="City not found",console.log(t)),t}}catch(t){console.log(t),document.getElementById("error").style.display="block",document.getElementById("error").textContent="Connection issue. Please try again."}})().then((t=>d(t))).then((t=>i(t))),!1),l=()=>{document.getElementById("error").style.display="none",document.getElementById("result-data").style.display="none";let t=document.getElementsByClassName("values");for(let e=0;e<t.length;e++)t[e].textContent=""};function c(t){const o=t.coords;e=o.latitude,n=o.longitude,console.log(`Latitude : ${e}`),console.log(`Longitude: ${n}`),(async()=>{const t=`/.netlify/functions/fetch_air_coords?lat=${e}&long=${n}`;try{const e=await fetch(t);if(e.ok){const t=await e.json();return console.log(t),t}}catch(t){console.log(t)}})().then((t=>d(t))).then((t=>i(t)))}function a(t){console.warn(`ERROR(${t.code}): ${t.message}`),document.getElementById("error").style.display="block",document.getElementById("error").textContent="Geolocation denied"}const r={enableHighAccuracy:!0,timeout:5e3,maximumAge:0};document.getElementById("button").addEventListener("click",o),document.getElementById("getloc").addEventListener("click",(function(){l(),navigator.geolocation.getCurrentPosition(c,a,r)}));const d=t=>{if("error"===t.status)return;document.getElementById("result-data").style.display="block";let e=t.data.aqi;const n=t.data.city.name;document.getElementById("result-city").textContent=n,e>0?document.getElementById("aqi").textContent=e:(document.getElementById("aqi").textContent="N/A",document.getElementById("color").style.display="none");const o=["pm25","pm10","no2","o3"];for(let e of o)t.data.iaqi.hasOwnProperty(e)?document.getElementById(e).textContent=t.data.iaqi[e].v:document.getElementById(e).textContent="N/A";let l,c,a;return e<=50&&e>=0?(l="Good",c="green",a="white"):e>50&&e<=100?(l="Moderate",c="yellow",a="black"):e>100&&e<=150?(l="Unhealthy for Sensitive Groups",c="orange",a="black"):e>150&&e<=200?(l="Unhealthy",c="red",a="white"):e>200&&e<=300?(l="Very Unhealthy",c="purple",a="white"):e>300?(l="Hazardous",c="maroon",a="white"):document.getElementById("color").style.display="none",document.getElementById("color").textContent=l,document.getElementById("color").style.backgroundColor=c,document.getElementById("color").style.color=a,t};function i(e){let n=e.data.city.geo[0],o=e.data.city.geo[1];null!=t&&t.remove(),t=L.map("map").setView([n,o],12),L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19,attribution:'&copy; <a href="https://openstreetmap.org/copyright">OpenStreetMap contributors</a>'}).addTo(t),L.marker([n,o]).addTo(t)}})();